<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TOOL - NGURAS + LAG + PING MONITOR (HP-Friendly)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; background: #0d1117; color: #c9d1d9; }
    h1 { color: #ff5555; font-size: 28px; }
    #log { width: 100%; max-width: 960px; height: 480px; border: 1px solid #444; padding: 12px; overflow-y: auto; background: #161b22; font-family: monospace; font-size: 14px; line-height: 1.5; }
    button { padding: 12px 28px; margin: 10px 10px 10px 0; font-size: 16px; cursor: pointer; background: #21262d; color: #c9d1d9; border: 1px solid #444; }
    button:hover { background: #30363d; }
    .warning { color: #ffa500; font-weight: bold; }
    .ping-high { color: #ff4444; font-weight: bold; }
    .ping-medium { color: #ffaa00; }
    .ping-low { color: #44ff44; }
    input { padding: 10px; font-size: 16px; background: #0d1117; color: #c9d1d9; border: 1px solid #444; width: 200px; }
  </style>
</head>
<body>

  <h1>TOOL – NGURAS KUOTA + BIKIN JARINGAN LEMOT + MONITOR PING</h1>
  <p class="warning">Kuota habis cepat + latency naik tinggi | HP tetap lancar | Ping ditampilkan real-time</p>

  <div id="password-screen">
    <p>Masukkan password:</p>
    <input type="password" id="pass">
    <button onclick="checkPass()">Masuk</button>
    <p id="wrong" style="color:#ff5555; display:none;">Password salah</p>
  </div>

  <div id="main" style="display:none;">
    <button onclick="start()">MULAI</button>
    <button onclick="stop()">BERHENTI</button>

    <div id="log">Status...</div>
  </div>

  <script>
    const PASSWORD = "1342";
    let isRunning = false;
    const logEl = document.getElementById('log');

    function checkPass() {
      if (document.getElementById('pass').value === PASSWORD) {
        document.getElementById('password-screen').style.display = 'none';
        document.getElementById('main').style.display = 'block';
        log("Akses diberikan. Mode nguras + lag + ping monitor aktif.");
      } else {
        document.getElementById('wrong').style.display = 'block';
        setTimeout(() => document.getElementById('wrong').style.display = 'none', 2000);
      }
    }

    const bigFiles = [
      "https://speed.hetzner.de/100GB.bin",
      "https://proof.ovh.net/files/100Gb.dat",
      "https://speed.cloudflare.com/__down?bytes=100000000000",
      "https://speed.cloudflare.com/__down?bytes=200000000000",
      "https://speedtest.tele2.net/100GB.zip"
    ];

    const pingTargets = [
      { name: "Google DNS", url: "https://8.8.8.8/generate_204" },
      { name: "Cloudflare", url: "https://1.1.1.1" },
      { name: "Quad9", url: "https://9.9.9.9" },
      { name: "OpenDNS", url: "https://208.67.222.222" },
      { name: "YouTube", url: "https://www.youtube.com/generate_204" }
    ];

    function log(text, className = "") {
      const time = new Date().toLocaleTimeString();
      const line = `[${time}] ${text}<br>`;
      const div = document.createElement('div');
      div.innerHTML = line;
      if (className) div.className = className;
      logEl.appendChild(div);
      logEl.scrollTop = logEl.scrollHeight;
    }

    // ─── Ukur ping ke satu target ───────────────────────────────────────
    async function measurePing(target) {
      const start = performance.now();
      try {
        await fetch(target.url, {
          mode: 'no-cors',
          cache: 'no-store',
          keepalive: true
        });
        const end = performance.now();
        const ping = Math.round(end - start);
        let cls = "ping-low";
        if (ping > 120) cls = "ping-high";
        else if (ping > 60) cls = "ping-medium";
        log(`Ping ${target.name}: ${ping} ms`, cls);
      } catch (e) {
        log(`Ping ${target.name}: gagal / timeout`, "ping-high");
      }
    }

    // ─── Ping monitor berjalan terus selama aktif ───────────────────────
    async function pingMonitor() {
      if (!isRunning) return;

      log("--- PING STATUS ---");
      for (const target of pingTargets) {
        await measurePing(target);
        await new Promise(r => setTimeout(r, 300)); // jeda antar ping biar tidak terlalu padat
      }
      log("-------------------");

      setTimeout(pingMonitor, 5000); // ulang setiap ~5 detik
    }

    // ─── Download besar (nguras kuota) ───────────────────────────────────
    async function consumeBig(url) {
      try {
        const cb = `?ts=\( {Date.now()}_ \){Math.random().toString(36).slice(2)}`;
        const res = await fetch(url + cb, {
          cache: 'no-store',
          mode: 'no-cors',
          keepalive: true,
          referrerPolicy: 'no-referrer'
        });

        if (res.body) {
          const reader = res.body.getReader();
          while (true) {
            const { done } = await reader.read();
            if (done) break;
            await new Promise(r => setTimeout(r, 0));
          }
        }
      } catch (e) {}
    }

    // ─── Spam koneksi kecil (bufferbloat & latency naik) ─────────────────
    async function spamSmallPackets() {
      if (!isRunning) return;

      const domain = pingTargets[Math.floor(Math.random() * pingTargets.length)].url.replace("https://", "").split("/")[0];
      log(`Spam kecil ke → ${domain}`);

      const promises = [];
      for (let i = 0; i < 10; i++) {
        promises.push(
          fetch(`https://\( {domain}/?spam= \){Date.now()}_\( {i}_ \){Math.random().toString(36).slice(2)}`, {
            mode: 'no-cors',
            cache: 'no-store',
            keepalive: true
          }).catch(() => {})
        );
      }

      await Promise.allSettled(promises);
      setTimeout(spamSmallPackets, 180 + Math.random() * 420);
    }

    // ─── Worker nguras bandwidth ────────────────────────────────────────
    async function bandwidthWorker() {
      while (isRunning) {
        const url = bigFiles[Math.floor(Math.random() * bigFiles.length)];
        log(`Nguras → ${url.split('/').pop() || url}`);

        const tasks = [];
        for (let i = 0; i < 8; i++) {
          tasks.push(consumeBig(url));
        }

        await Promise.allSettled(tasks);
        await new Promise(r => setTimeout(r, 500 + Math.random() * 1000));
      }
    }

    function start() {
      if (isRunning) return;
      isRunning = true;
      log("<span style='color:#ffaa00'>MULAI – NGURAS KUOTA + LATENCY NAIK + PING MONITOR AKTIF</span>");

      // Nguras kuota
      for (let i = 0; i < 22; i++) {
        bandwidthWorker();
      }

      // Spam kecil untuk lag
      spamSmallPackets();
      spamSmallPackets();

      // Mulai monitor ping
      pingMonitor();
    }

    function stop() {
      isRunning = false;
      log("Semua dihentikan. Ping monitor juga mati.");
    }

  </script>

</body>
</html>